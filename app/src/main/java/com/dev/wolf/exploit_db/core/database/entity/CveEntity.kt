package com.dev.wolf.exploit_db.core.database.entity

import androidx.room.ColumnInfo
import androidx.room.Entity
import androidx.room.PrimaryKey
import com.dev.wolf.exploit_db.core.model.CVE
import com.dev.wolf.exploit_db.utils.ext.longHashCode

@Entity(tableName = "cves")
data class CveEntity(
    @PrimaryKey(autoGenerate = false)
    @ColumnInfo(name = "cve_id") val id: Long,
    @ColumnInfo(name = "code") val code: String,
    @ColumnInfo(name = "code_type") val code_type: String,
    @ColumnInfo(name = "code_id") val code_id: String,
) {

    fun toCVE() = CVE(
        code = this.code,
        code_type = this.code_type,
        code_id = this.code_id
    )

    companion object {

        fun fromCVE(cve: CVE) = CveEntity(
            code = cve.code,
            code_type = cve.code_type,
            code_id = cve.code_id,
            id = cve.code_id.longHashCode()
        )
    }
}